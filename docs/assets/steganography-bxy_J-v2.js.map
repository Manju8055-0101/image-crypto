{"version":3,"file":"steganography-bxy_J-v2.js","sources":["../../src/lib/encryption.js","../../src/lib/steganography.js"],"sourcesContent":["import CryptoJS from 'crypto-js'\n\nconst SALT_LENGTH = 16\nconst IV_LENGTH = 16\nconst KEY_ITERATIONS = 100000\nconst KEY_LENGTH = 256\n\nexport const generateSalt = () => {\n  return CryptoJS.lib.WordArray.random(SALT_LENGTH).toString()\n}\n\nexport const generateIV = () => {\n  return CryptoJS.lib.WordArray.random(IV_LENGTH).toString()\n}\n\nexport const deriveKey = (password, salt) => {\n  return CryptoJS.PBKDF2(password, salt, {\n    keySize: KEY_LENGTH / 32,\n    iterations: KEY_ITERATIONS,\n    hasher: CryptoJS.algo.SHA256,\n  })\n}\n\nexport const encrypt = (plaintext, password) => {\n  try {\n    const salt = generateSalt()\n    const iv = generateIV()\n    const key = deriveKey(password, salt)\n\n    const encrypted = CryptoJS.AES.encrypt(plaintext, key, {\n      iv: CryptoJS.enc.Hex.parse(iv),\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7,\n    })\n\n    const checksum = CryptoJS.SHA256(plaintext).toString()\n\n    const result = {\n      ciphertext: encrypted.ciphertext.toString(CryptoJS.enc.Base64),\n      salt,\n      iv,\n      checksum,\n    }\n\n    return JSON.stringify(result)\n  } catch (error) {\n    throw new Error('Encryption failed: ' + error.message)\n  }\n}\n\nexport const decrypt = (encryptedData, password) => {\n  try {\n    const data = JSON.parse(encryptedData)\n\n    if (!data.ciphertext || !data.salt || !data.iv || !data.checksum) {\n      throw new Error('Invalid encrypted data format')\n    }\n\n    const key = deriveKey(password, data.salt)\n\n    const cipherParams = CryptoJS.lib.CipherParams.create({\n      ciphertext: CryptoJS.enc.Base64.parse(data.ciphertext),\n    })\n\n    const decrypted = CryptoJS.AES.decrypt(cipherParams, key, {\n      iv: CryptoJS.enc.Hex.parse(data.iv),\n      mode: CryptoJS.mode.CBC,\n      padding: CryptoJS.pad.Pkcs7,\n    })\n\n    const decryptedString = decrypted.toString(CryptoJS.enc.Utf8)\n\n    if (!decryptedString) {\n      throw new Error('Decryption failed - wrong password or corrupted data')\n    }\n\n    const checksum = CryptoJS.SHA256(decryptedString).toString()\n\n    if (checksum !== data.checksum) {\n      throw new Error('Data integrity check failed - data may be corrupted')\n    }\n\n    return decryptedString\n  } catch (error) {\n    if (error.message.includes('wrong password') || error.message.includes('Invalid encrypted data')) {\n      throw new Error('Invalid password or corrupted data')\n    }\n    throw error\n  }\n}\n\nexport const generateChecksum = (data) => {\n  return CryptoJS.SHA256(data).toString()\n}\n\nexport const verifyChecksum = (data, checksum) => {\n  return generateChecksum(data) === checksum\n}\n","import { encrypt, decrypt } from './encryption'\n\nconst METADATA_SEPARATOR = '|||META|||'\nconst MESSAGE_SEPARATOR = '|||MSG|||'\n\nconst loadImage = (src) => {\n  return new Promise((resolve, reject) => {\n    const img = new Image()\n    img.crossOrigin = 'Anonymous'\n    img.onload = () => resolve(img)\n    img.onerror = reject\n    img.src = src\n  })\n}\n\nconst getImageData = (canvas, ctx, img) => {\n  canvas.width = img.width\n  canvas.height = img.height\n  ctx.drawImage(img, 0, 0)\n  return ctx.getImageData(0, 0, img.width, img.height)\n}\n\nconst putImageData = (canvas, ctx, imageData) => {\n  canvas.width = imageData.width\n  canvas.height = imageData.height\n  ctx.putImageData(imageData, 0, 0)\n}\n\nconst textToBinary = (text) => {\n  let binary = ''\n  for (let i = 0; i < text.length; i++) {\n    const bin = text.charCodeAt(i).toString(2).padStart(8, '0')\n    binary += bin\n  }\n  return binary\n}\n\nconst binaryToText = (binary) => {\n  let text = ''\n  for (let i = 0; i < binary.length; i += 8) {\n    const bin = binary.slice(i, i + 8)\n    if (bin.length === 8) {\n      text += String.fromCharCode(parseInt(bin, 2))\n    }\n  }\n  return text\n}\n\nconst binaryToArray = (binary) => {\n  return binary.split('').map(Number)\n}\n\nconst arrayToBinary = (arr) => {\n  return arr.join('')\n}\n\nconst lsbEmbed = (imageData, binaryData) => {\n  const data = imageData.data\n  const binaryArray = binaryToArray(binaryData)\n  \n  if (binaryArray.length > data.length / 4) {\n    throw new Error('Message too large for selected image. Try a larger image or shorter message.')\n  }\n\n  let bitIndex = 0\n  for (let i = 0; i < data.length && bitIndex < binaryArray.length; i += 4) {\n    for (let j = 0; j < 3 && bitIndex < binaryArray.length; j++) {\n      data[i + j] = (data[i + j] & 0xFE) | binaryArray[bitIndex]\n      bitIndex++\n    }\n  }\n\n  return imageData\n}\n\nconst lsbExtract = (imageData, bitLength) => {\n  const data = imageData.data\n  let binary = ''\n  let bitIndex = 0\n\n  for (let i = 0; i < data.length && bitIndex < bitLength; i += 4) {\n    for (let j = 0; j < 3 && bitIndex < bitLength; j++) {\n      binary += (data[i + j] & 1).toString()\n      bitIndex++\n    }\n  }\n\n  return binary\n}\n\nconst pvdEmbed = (imageData, binaryData) => {\n  const data = imageData.data\n  const binaryArray = binaryToArray(binaryData)\n  \n  if (binaryArray.length > data.length / 4 * 1.5) {\n    throw new Error('Message too large for selected image.')\n  }\n\n  let bitIndex = 0\n  for (let i = 0; i < data.length - 4 && bitIndex < binaryArray.length; i += 4) {\n    const r1 = data[i]\n    const g1 = data[i + 1]\n    const b1 = data[i + 2]\n    \n    if (bitIndex >= binaryArray.length) break\n    \n    const diff = Math.abs(r1 - g1) + Math.abs(g1 - b1) + Math.abs(b1 - r1)\n    \n    if (diff < 50) {\n      if (bitIndex < binaryArray.length) {\n        const newVal = (data[i] & 0xFE) | binaryArray[bitIndex]\n        data[i] = newVal\n        bitIndex++\n      }\n      if (bitIndex < binaryArray.length) {\n        const newVal = (data[i + 1] & 0xFE) | binaryArray[bitIndex]\n        data[i + 1] = newVal\n        bitIndex++\n      }\n      if (bitIndex < binaryArray.length) {\n        const newVal = (data[i + 2] & 0xFE) | binaryArray[bitIndex]\n        data[i + 2] = newVal\n        bitIndex++\n      }\n    }\n  }\n\n  return imageData\n}\n\nconst pvdExtract = (imageData, bitLength) => {\n  const data = imageData.data\n  let binary = ''\n  let bitIndex = 0\n\n  for (let i = 0; i < data.length - 4 && bitIndex < bitLength; i += 4) {\n    const r1 = data[i]\n    const g1 = data[i + 1]\n    const b1 = data[i + 2]\n    \n    const diff = Math.abs(r1 - g1) + Math.abs(g1 - b1) + Math.abs(b1 - r1)\n    \n    if (diff < 50) {\n      if (bitIndex < bitLength) {\n        binary += (data[i] & 1).toString()\n        bitIndex++\n      }\n      if (bitIndex < bitLength) {\n        binary += (data[i + 1] & 1).toString()\n        bitIndex++\n      }\n      if (bitIndex < bitLength) {\n        binary += (data[i + 2] & 1).toString()\n        bitIndex++\n      }\n    }\n  }\n\n  return binary\n}\n\nconst dwtEmbed = (imageData, binaryData) => {\n  const data = imageData.data\n  const width = imageData.width\n  const height = imageData.height\n  \n  if (binaryArray.length > data.length / 8) {\n    throw new Error('Message too large for selected image.')\n  }\n\n  const binaryArray = binaryToArray(binaryData)\n  let bitIndex = 0\n\n  for (let y = 0; y < height && bitIndex < binaryArray.length; y += 2) {\n    for (let x = 0; x < width && bitIndex < binaryArray.length; x += 2) {\n      const idx = (y * width + x) * 4\n      const idx2 = (y * width + x + 1) * 4\n      const idx3 = ((y + 1) * width + x) * 4\n\n      if (idx < data.length && idx2 < data.length && idx3 < data.length) {\n        for (let j = 0; j < 3 && bitIndex < binaryArray.length; j++) {\n          const avg = Math.floor((data[idx + j] + data[idx2 + j] + data[idx3 + j] + \n            (data[idx + 4] || data[idx + j])) / 4)\n          data[idx + j] = (avg & 0xFE) | binaryArray[bitIndex]\n          bitIndex++\n        }\n      }\n    }\n  }\n\n  return imageData\n}\n\nconst dwtExtract = (imageData, bitLength) => {\n  const data = imageData.data\n  const width = imageData.width\n  const height = imageData.height\n  \n  let binary = ''\n  let bitIndex = 0\n\n  for (let y = 0; y < height && bitIndex < bitLength; y += 2) {\n    for (let x = 0; x < width && bitIndex < bitLength; x += 2) {\n      const idx = (y * width + x) * 4\n      \n      if (idx < data.length) {\n        for (let j = 0; j < 3 && bitIndex < bitLength; j++) {\n          binary += (data[idx + j] & 1).toString()\n          bitIndex++\n        }\n      }\n    }\n  }\n\n  return binary\n}\n\nexport const encryptMessage = async (imageSrc, message, password, algorithm = 'lsb') => {\n  const canvas = document.createElement('canvas')\n  const ctx = canvas.getContext('2d')\n  const img = await loadImage(imageSrc)\n  const imageData = getImageData(canvas, ctx, img)\n\n  const encryptedMessage = encrypt(message, password)\n  const metadata = JSON.stringify({\n    algorithm,\n    originalLength: message.length,\n    encryptedLength: encryptedMessage.length,\n  })\n  \n  const fullData = metadata + METADATA_SEPARATOR + encryptedMessage + MESSAGE_SEPARATOR + message.length\n  const binaryData = textToBinary(fullData)\n\n  let modifiedImageData\n  switch (algorithm) {\n    case 'lsb':\n      modifiedImageData = lsbEmbed(imageData, binaryData)\n      break\n    case 'pvd':\n      modifiedImageData = pvdEmbed(imageData, binaryData)\n      break\n    case 'dwt':\n      modifiedImageData = dwtEmbed(imageData, binaryData)\n      break\n    default:\n      modifiedImageData = lsbEmbed(imageData, binaryData)\n  }\n\n  putImageData(canvas, ctx, modifiedImageData)\n\n  return canvas.toDataURL('image/png', 1.0)\n}\n\nexport const decryptMessage = async (imageSrc, password) => {\n  const canvas = document.createElement('canvas')\n  const ctx = canvas.getContext('2d')\n  const img = await loadImage(imageSrc)\n  const imageData = getImageData(canvas, ctx, img)\n\n  const totalBinaryLength = 8 * (JSON.stringify({ algorithm: 'lsb', originalLength: 0, encryptedLength: 0 }).length + \n    METADATA_SEPARATOR.length + 500 + MESSAGE_SEPARATOR.length + 10)\n\n  let binaryData\n  switch (img.src.includes('algorithm=pvd') ? 'pvd' : 'lsb') {\n    case 'lsb':\n      binaryData = lsbExtract(imageData, totalBinaryLength)\n      break\n    case 'pvd':\n      binaryData = pvdExtract(imageData, totalBinaryLength)\n      break\n    case 'dwt':\n      binaryData = dwtExtract(imageData, totalBinaryLength)\n      break\n    default:\n      binaryData = lsbExtract(imageData, totalBinaryLength)\n  }\n\n  const fullText = binaryToText(binaryData)\n  \n  const metaEnd = fullText.indexOf(METADATA_SEPARATOR)\n  const msgEnd = fullText.indexOf(MESSAGE_SEPARATOR)\n\n  if (metaEnd === -1 || msgEnd === -1) {\n    return { success: false, message: 'No hidden message found in this image' }\n  }\n\n  try {\n    const metadata = JSON.parse(fullText.slice(0, metaEnd))\n    const encryptedData = fullText.slice(metaEnd + METADATA_SEPARATOR.length, msgEnd)\n    const originalLength = parseInt(fullText.slice(msgEnd + MESSAGE_SEPARATOR.length))\n\n    const decryptedMessage = decrypt(encryptedData, password)\n    \n    return { success: true, message: decryptedMessage, metadata }\n  } catch (error) {\n    return { success: false, message: error.message || 'Failed to decrypt message' }\n  }\n}\n\nexport const calculateCapacity = (width, height, algorithm = 'lsb') => {\n  const totalPixels = width * height\n  const bytesPerPixel = 3\n  \n  switch (algorithm) {\n    case 'lsb':\n      return Math.floor(totalPixels * bytesPerPixel * 0.25)\n    case 'pvd':\n      return Math.floor(totalPixels * bytesPerPixel * 0.18)\n    case 'dwt':\n      return Math.floor(totalPixels * bytesPerPixel * 0.12)\n    default:\n      return Math.floor(totalPixels * bytesPerPixel * 0.25)\n  }\n}\n"],"names":["SALT_LENGTH","IV_LENGTH","KEY_ITERATIONS","KEY_LENGTH","generateSalt","CryptoJS","generateIV","deriveKey","password","salt","encrypt","plaintext","iv","key","encrypted","checksum","result","error","decrypt","encryptedData","data","cipherParams","decryptedString","METADATA_SEPARATOR","MESSAGE_SEPARATOR","loadImage","src","resolve","reject","img","getImageData","canvas","ctx","putImageData","imageData","textToBinary","text","binary","i","bin","binaryToText","binaryToArray","lsbEmbed","binaryData","binaryArray","bitIndex","j","lsbExtract","bitLength","pvdEmbed","r1","g1","b1","newVal","pvdExtract","dwtEmbed","width","height","y","x","idx","idx2","idx3","avg","dwtExtract","encryptMessage","imageSrc","message","algorithm","encryptedMessage","fullData","modifiedImageData","decryptMessage","totalBinaryLength","fullText","metaEnd","msgEnd","metadata","originalLength"],"mappings":"yCAEA,MAAMA,EAAc,GACdC,EAAY,GACZC,EAAiB,IACjBC,EAAa,IAENC,EAAe,IACnBC,EAAS,IAAI,UAAU,OAAOL,CAAW,EAAE,SAAQ,EAG/CM,EAAa,IACjBD,EAAS,IAAI,UAAU,OAAOJ,CAAS,EAAE,SAAQ,EAG7CM,EAAY,CAACC,EAAUC,IAC3BJ,EAAS,OAAOG,EAAUC,EAAM,CACrC,QAASN,EAAa,GACtB,WAAYD,EACZ,OAAQG,EAAS,KAAK,MAC1B,CAAG,EAGUK,EAAU,CAACC,EAAWH,IAAa,CAC9C,GAAI,CACF,MAAMC,EAAOL,EAAY,EACnBQ,EAAKN,EAAU,EACfO,EAAMN,EAAUC,EAAUC,CAAI,EAE9BK,EAAYT,EAAS,IAAI,QAAQM,EAAWE,EAAK,CACrD,GAAIR,EAAS,IAAI,IAAI,MAAMO,CAAE,EAC7B,KAAMP,EAAS,KAAK,IACpB,QAASA,EAAS,IAAI,KAC5B,CAAK,EAEKU,EAAWV,EAAS,OAAOM,CAAS,EAAE,SAAQ,EAE9CK,EAAS,CACb,WAAYF,EAAU,WAAW,SAAST,EAAS,IAAI,MAAM,EAC7D,KAAAI,EACA,GAAAG,EACA,SAAAG,CACN,EAEI,OAAO,KAAK,UAAUC,CAAM,CAC9B,OAASC,EAAO,CACd,MAAM,IAAI,MAAM,sBAAwBA,EAAM,OAAO,CACvD,CACF,EAEaC,EAAU,CAACC,EAAeX,IAAa,CAClD,GAAI,CACF,MAAMY,EAAO,KAAK,MAAMD,CAAa,EAErC,GAAI,CAACC,EAAK,YAAc,CAACA,EAAK,MAAQ,CAACA,EAAK,IAAM,CAACA,EAAK,SACtD,MAAM,IAAI,MAAM,+BAA+B,EAGjD,MAAMP,EAAMN,EAAUC,EAAUY,EAAK,IAAI,EAEnCC,EAAehB,EAAS,IAAI,aAAa,OAAO,CACpD,WAAYA,EAAS,IAAI,OAAO,MAAMe,EAAK,UAAU,CAC3D,CAAK,EAQKE,EANYjB,EAAS,IAAI,QAAQgB,EAAcR,EAAK,CACxD,GAAIR,EAAS,IAAI,IAAI,MAAMe,EAAK,EAAE,EAClC,KAAMf,EAAS,KAAK,IACpB,QAASA,EAAS,IAAI,KAC5B,CAAK,EAEiC,SAASA,EAAS,IAAI,IAAI,EAE5D,GAAI,CAACiB,EACH,MAAM,IAAI,MAAM,sDAAsD,EAKxE,GAFiBjB,EAAS,OAAOiB,CAAe,EAAE,SAAQ,IAEzCF,EAAK,SACpB,MAAM,IAAI,MAAM,qDAAqD,EAGvE,OAAOE,CACT,OAASL,EAAO,CACd,MAAIA,EAAM,QAAQ,SAAS,gBAAgB,GAAKA,EAAM,QAAQ,SAAS,wBAAwB,EACvF,IAAI,MAAM,oCAAoC,EAEhDA,CACR,CACF,ECvFMM,EAAqB,aACrBC,EAAoB,YAEpBC,EAAaC,GACV,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtC,MAAMC,EAAM,IAAI,MAChBA,EAAI,YAAc,YAClBA,EAAI,OAAS,IAAMF,EAAQE,CAAG,EAC9BA,EAAI,QAAUD,EACdC,EAAI,IAAMH,CACZ,CAAC,EAGGI,EAAe,CAACC,EAAQC,EAAKH,KACjCE,EAAO,MAAQF,EAAI,MACnBE,EAAO,OAASF,EAAI,OACpBG,EAAI,UAAUH,EAAK,EAAG,CAAC,EAChBG,EAAI,aAAa,EAAG,EAAGH,EAAI,MAAOA,EAAI,MAAM,GAG/CI,EAAe,CAACF,EAAQC,EAAKE,IAAc,CAC/CH,EAAO,MAAQG,EAAU,MACzBH,EAAO,OAASG,EAAU,OAC1BF,EAAI,aAAaE,EAAW,EAAG,CAAC,CAClC,EAEMC,EAAgBC,GAAS,CAC7B,IAAIC,EAAS,GACb,QAASC,EAAI,EAAGA,EAAIF,EAAK,OAAQE,IAAK,CACpC,MAAMC,EAAMH,EAAK,WAAWE,CAAC,EAAE,SAAS,CAAC,EAAE,SAAS,EAAG,GAAG,EAC1DD,GAAUE,CACZ,CACA,OAAOF,CACT,EAEMG,EAAgBH,GAAW,CAC/B,IAAID,EAAO,GACX,QAASE,EAAI,EAAGA,EAAID,EAAO,OAAQC,GAAK,EAAG,CACzC,MAAMC,EAAMF,EAAO,MAAMC,EAAGA,EAAI,CAAC,EAC7BC,EAAI,SAAW,IACjBH,GAAQ,OAAO,aAAa,SAASG,EAAK,CAAC,CAAC,EAEhD,CACA,OAAOH,CACT,EAEMK,EAAiBJ,GACdA,EAAO,MAAM,EAAE,EAAE,IAAI,MAAM,EAO9BK,EAAW,CAACR,EAAWS,IAAe,CAC1C,MAAMvB,EAAOc,EAAU,KACjBU,EAAcH,EAAcE,CAAU,EAE5C,GAAIC,EAAY,OAASxB,EAAK,OAAS,EACrC,MAAM,IAAI,MAAM,8EAA8E,EAGhG,IAAIyB,EAAW,EACf,QAASP,EAAI,EAAGA,EAAIlB,EAAK,QAAUyB,EAAWD,EAAY,OAAQN,GAAK,EACrE,QAASQ,EAAI,EAAGA,EAAI,GAAKD,EAAWD,EAAY,OAAQE,IACtD1B,EAAKkB,EAAIQ,CAAC,EAAK1B,EAAKkB,EAAIQ,CAAC,EAAI,IAAQF,EAAYC,CAAQ,EACzDA,IAIJ,OAAOX,CACT,EAEMa,EAAa,CAACb,EAAWc,IAAc,CAC3C,MAAM5B,EAAOc,EAAU,KACvB,IAAIG,EAAS,GACTQ,EAAW,EAEf,QAASP,EAAI,EAAGA,EAAIlB,EAAK,QAAUyB,EAAWG,EAAWV,GAAK,EAC5D,QAASQ,EAAI,EAAGA,EAAI,GAAKD,EAAWG,EAAWF,IAC7CT,IAAWjB,EAAKkB,EAAIQ,CAAC,EAAI,GAAG,SAAQ,EACpCD,IAIJ,OAAOR,CACT,EAEMY,EAAW,CAACf,EAAWS,IAAe,CAC1C,MAAMvB,EAAOc,EAAU,KACjBU,EAAcH,EAAcE,CAAU,EAE5C,GAAIC,EAAY,OAASxB,EAAK,OAAS,EAAI,IACzC,MAAM,IAAI,MAAM,uCAAuC,EAGzD,IAAIyB,EAAW,EACf,QAASP,EAAI,EAAGA,EAAIlB,EAAK,OAAS,GAAKyB,EAAWD,EAAY,OAAQN,GAAK,EAAG,CAC5E,MAAMY,EAAK9B,EAAKkB,CAAC,EACXa,EAAK/B,EAAKkB,EAAI,CAAC,EACfc,EAAKhC,EAAKkB,EAAI,CAAC,EAErB,GAAIO,GAAYD,EAAY,OAAQ,MAIpC,GAFa,KAAK,IAAIM,EAAKC,CAAE,EAAI,KAAK,IAAIA,EAAKC,CAAE,EAAI,KAAK,IAAIA,EAAKF,CAAE,EAE1D,GAAI,CACb,GAAIL,EAAWD,EAAY,OAAQ,CACjC,MAAMS,EAAUjC,EAAKkB,CAAC,EAAI,IAAQM,EAAYC,CAAQ,EACtDzB,EAAKkB,CAAC,EAAIe,EACVR,GACF,CACA,GAAIA,EAAWD,EAAY,OAAQ,CACjC,MAAMS,EAAUjC,EAAKkB,EAAI,CAAC,EAAI,IAAQM,EAAYC,CAAQ,EAC1DzB,EAAKkB,EAAI,CAAC,EAAIe,EACdR,GACF,CACA,GAAIA,EAAWD,EAAY,OAAQ,CACjC,MAAMS,EAAUjC,EAAKkB,EAAI,CAAC,EAAI,IAAQM,EAAYC,CAAQ,EAC1DzB,EAAKkB,EAAI,CAAC,EAAIe,EACdR,GACF,CACF,CACF,CAEA,OAAOX,CACT,EAEMoB,EAAa,CAACpB,EAAWc,IAAc,CAC3C,MAAM5B,EAAOc,EAAU,KACvB,IAAIG,EAAS,GACTQ,EAAW,EAEf,QAASP,EAAI,EAAGA,EAAIlB,EAAK,OAAS,GAAKyB,EAAWG,EAAWV,GAAK,EAAG,CACnE,MAAMY,EAAK9B,EAAKkB,CAAC,EACXa,EAAK/B,EAAKkB,EAAI,CAAC,EACfc,EAAKhC,EAAKkB,EAAI,CAAC,EAER,KAAK,IAAIY,EAAKC,CAAE,EAAI,KAAK,IAAIA,EAAKC,CAAE,EAAI,KAAK,IAAIA,EAAKF,CAAE,EAE1D,KACLL,EAAWG,IACbX,IAAWjB,EAAKkB,CAAC,EAAI,GAAG,SAAQ,EAChCO,KAEEA,EAAWG,IACbX,IAAWjB,EAAKkB,EAAI,CAAC,EAAI,GAAG,SAAQ,EACpCO,KAEEA,EAAWG,IACbX,IAAWjB,EAAKkB,EAAI,CAAC,EAAI,GAAG,SAAQ,EACpCO,KAGN,CAEA,OAAOR,CACT,EAEMkB,EAAW,CAACrB,EAAWS,IAAe,CAC1C,MAAMvB,EAAOc,EAAU,KACjBsB,EAAQtB,EAAU,MAClBuB,EAASvB,EAAU,OAEzB,GAAIU,EAAY,OAASxB,EAAK,OAAS,EACrC,MAAM,IAAI,MAAM,uCAAuC,EAGzD,MAAMwB,EAAcH,EAAcE,CAAU,EAC5C,IAAIE,EAAW,EAEf,QAASa,EAAI,EAAGA,EAAID,GAAUZ,EAAWD,EAAY,OAAQc,GAAK,EAChE,QAASC,EAAI,EAAGA,EAAIH,GAASX,EAAWD,EAAY,OAAQe,GAAK,EAAG,CAClE,MAAMC,GAAOF,EAAIF,EAAQG,GAAK,EACxBE,GAAQH,EAAIF,EAAQG,EAAI,GAAK,EAC7BG,IAASJ,EAAI,GAAKF,EAAQG,GAAK,EAErC,GAAIC,EAAMxC,EAAK,QAAUyC,EAAOzC,EAAK,QAAU0C,EAAO1C,EAAK,OACzD,QAAS0B,EAAI,EAAGA,EAAI,GAAKD,EAAWD,EAAY,OAAQE,IAAK,CAC3D,MAAMiB,EAAM,KAAK,OAAO3C,EAAKwC,EAAMd,CAAC,EAAI1B,EAAKyC,EAAOf,CAAC,EAAI1B,EAAK0C,EAAOhB,CAAC,GACnE1B,EAAKwC,EAAM,CAAC,GAAKxC,EAAKwC,EAAMd,CAAC,IAAM,CAAC,EACvC1B,EAAKwC,EAAMd,CAAC,EAAKiB,EAAM,IAAQnB,EAAYC,CAAQ,EACnDA,GACF,CAEJ,CAGF,OAAOX,CACT,EAEM8B,EAAa,CAAC9B,EAAWc,IAAc,CAC3C,MAAM5B,EAAOc,EAAU,KACjBsB,EAAQtB,EAAU,MAClBuB,EAASvB,EAAU,OAEzB,IAAIG,EAAS,GACTQ,EAAW,EAEf,QAASa,EAAI,EAAGA,EAAID,GAAUZ,EAAWG,EAAWU,GAAK,EACvD,QAASC,EAAI,EAAGA,EAAIH,GAASX,EAAWG,EAAWW,GAAK,EAAG,CACzD,MAAMC,GAAOF,EAAIF,EAAQG,GAAK,EAE9B,GAAIC,EAAMxC,EAAK,OACb,QAAS0B,EAAI,EAAGA,EAAI,GAAKD,EAAWG,EAAWF,IAC7CT,IAAWjB,EAAKwC,EAAMd,CAAC,EAAI,GAAG,SAAQ,EACtCD,GAGN,CAGF,OAAOR,CACT,EAEa4B,EAAiB,MAAOC,EAAUC,EAAS3D,EAAU4D,EAAY,QAAU,CACtF,MAAMrC,EAAS,SAAS,cAAc,QAAQ,EACxCC,EAAMD,EAAO,WAAW,IAAI,EAC5BF,EAAM,MAAMJ,EAAUyC,CAAQ,EAC9BhC,EAAYJ,EAAaC,EAAQC,EAAKH,CAAG,EAEzCwC,EAAmB3D,EAAQyD,EAAS3D,CAAQ,EAO5C8D,EANW,KAAK,UAAU,CAC9B,UAAAF,EACA,eAAgBD,EAAQ,OACxB,gBAAiBE,EAAiB,MACtC,CAAG,EAE2B9C,EAAqB8C,EAAmB7C,EAAoB2C,EAAQ,OAC1FxB,EAAaR,EAAamC,CAAQ,EAExC,IAAIC,EACJ,OAAQH,EAAS,CACf,IAAK,MACHG,EAAoB7B,EAASR,EAAWS,CAAU,EAClD,MACF,IAAK,MACH4B,EAAoBtB,EAASf,EAAWS,CAAU,EAClD,MACF,IAAK,MACH4B,EAAoBhB,EAASrB,EAAWS,CAAU,EAClD,MACF,QACE4B,EAAoB7B,EAASR,EAAWS,CAAU,CACxD,CAEE,OAAAV,EAAaF,EAAQC,EAAKuC,CAAiB,EAEpCxC,EAAO,UAAU,YAAa,CAAG,CAC1C,EAEayC,EAAiB,MAAON,EAAU1D,IAAa,CAC1D,MAAMuB,EAAS,SAAS,cAAc,QAAQ,EACxCC,EAAMD,EAAO,WAAW,IAAI,EAC5BF,EAAM,MAAMJ,EAAUyC,CAAQ,EAC9BhC,EAAYJ,EAAaC,EAAQC,EAAKH,CAAG,EAEzC4C,EAAoB,GAAK,KAAK,UAAU,CAAE,UAAW,MAAO,eAAgB,EAAG,gBAAiB,CAAC,CAAE,EAAE,OACzGlD,EAAmB,OAAS,IAAMC,EAAkB,OAAS,IAE/D,IAAImB,EACJ,OAAQd,EAAI,IAAI,SAAS,eAAe,EAAI,MAAQ,MAAK,CACvD,IAAK,MACHc,EAAaI,EAAWb,EAAWuC,CAAiB,EACpD,MACF,IAAK,MACH9B,EAAaW,EAAWpB,EAAWuC,CAAiB,EACpD,MACF,IAAK,MACH9B,EAAaqB,EAAW9B,EAAWuC,CAAiB,EACpD,MACF,QACE9B,EAAaI,EAAWb,EAAWuC,CAAiB,CAC1D,CAEE,MAAMC,EAAWlC,EAAaG,CAAU,EAElCgC,EAAUD,EAAS,QAAQnD,CAAkB,EAC7CqD,EAASF,EAAS,QAAQlD,CAAiB,EAEjD,GAAImD,IAAY,IAAMC,IAAW,GAC/B,MAAO,CAAE,QAAS,GAAO,QAAS,uCAAuC,EAG3E,GAAI,CACF,MAAMC,EAAW,KAAK,MAAMH,EAAS,MAAM,EAAGC,CAAO,CAAC,EAChDxD,EAAgBuD,EAAS,MAAMC,EAAUpD,EAAmB,OAAQqD,CAAM,EAC1EE,EAAiB,SAASJ,EAAS,MAAME,EAASpD,EAAkB,MAAM,CAAC,EAIjF,MAAO,CAAE,QAAS,GAAM,QAFCN,EAAQC,EAAeX,CAAQ,EAEL,SAAAqE,CAAQ,CAC7D,OAAS5D,EAAO,CACd,MAAO,CAAE,QAAS,GAAO,QAASA,EAAM,SAAW,2BAA2B,CAChF,CACF"}
import{u as z,r,j as e,B as d}from"./index-CEymJGfU.js";import{m as p,C as u}from"./Card-BCg3rTDN.js";import{I as L}from"./Input-BntEy4Om.js";import{d as M}from"./steganography-CfUrt_Og.js";const T=()=>{const{selectedImage:t,password:i,isProcessing:m,decryptedMessage:x,setSelectedImage:c,setPassword:v,setIsProcessing:h,setDecryptedMessage:j,addToHistory:f,reset:N}=z(),[g,a]=r.useState(""),[b,o]=r.useState(!1),[w,n]=r.useState(!1),l=r.useCallback(s=>{if(!s)return;if(!s.type.startsWith("image/")){a("Please upload a valid image file");return}const y=new FileReader;y.onload=P=>{c({file:s,preview:P.target.result,name:s.name,size:s.size}),a(""),n(!1)},y.readAsDataURL(s)},[c]),k=r.useCallback(s=>{s.preventDefault(),s.stopPropagation(),o(!1),s.dataTransfer.files&&s.dataTransfer.files[0]&&l(s.dataTransfer.files[0])},[l]),D=async()=>{if(!t){a("Please select an encrypted image first");return}if(!i.trim()){a("Please enter the password");return}h(!0),a(""),n(!1);try{const s=await M(t.preview,i);j(s.message),n(s.success),s.success?f({type:"decrypt",originalSize:t.size,timestamp:new Date().toISOString(),status:"success"}):a(s.message||"Decryption failed. Wrong password or invalid image.")}catch(s){a(s.message||"Decryption failed. Please try again.")}finally{h(!1)}},C=()=>{navigator.clipboard.writeText(x)};return e.jsx("div",{className:"min-h-screen py-12",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold gradient-text mb-4",children:"Decrypt Message"}),e.jsx("p",{className:"text-crypto-text-secondary max-w-2xl mx-auto",children:"Extract hidden secret messages from encrypted images"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:e.jsxs(u,{children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"1. Upload Encrypted Image"}),e.jsx("div",{className:`relative border-2 border-dashed rounded-xl p-8 text-center transition-all duration-300 ${b?"border-crypto-accent bg-crypto-accent/10":"border-crypto-accent/30 hover:border-crypto-accent/50"}`,onDragEnter:s=>{s.preventDefault(),s.stopPropagation(),o(!0)},onDragLeave:s=>{s.preventDefault(),s.stopPropagation(),o(!1)},onDragOver:s=>{s.preventDefault(),s.stopPropagation()},onDrop:k,children:t?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.preview,alt:"Preview",className:"max-h-64 mx-auto rounded-lg"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-white font-medium",children:t.name}),e.jsxs("p",{className:"text-crypto-text-secondary text-sm",children:[(t.size/1024).toFixed(2)," KB"]}),e.jsx("button",{onClick:()=>c(null),className:"text-crypto-error text-sm mt-2 hover:underline",children:"Remove"})]})]}):e.jsxs("div",{className:"py-8",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-crypto-accent mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:"text-white mb-2",children:"Drag and drop an encrypted image here"}),e.jsx("p",{className:"text-crypto-text-secondary text-sm mb-4",children:"or"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"text-crypto-accent hover:underline",children:"Browse files"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:s=>l(s.target.files[0])})]})]})}),e.jsx("h2",{className:"text-xl font-semibold text-white mb-6 mt-6",children:"2. Enter Password"}),e.jsx(L,{type:"password",value:i,onChange:s=>v(s.target.value),placeholder:"Enter decryption password"}),g&&e.jsx("div",{className:"mt-4 p-3 bg-crypto-error/10 border border-crypto-error/30 rounded-lg text-crypto-error text-sm",children:g}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx(d,{variant:"primary",size:"lg",className:"flex-1",onClick:D,loading:m,disabled:!t||!i,children:m?"Decrypting...":"Decrypt Message"}),e.jsx(d,{variant:"ghost",size:"lg",onClick:N,children:"Reset"})]})]})}),e.jsx(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4},children:e.jsxs(u,{className:"sticky top-24",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Decrypted Message"}),w?e.jsxs("div",{children:[e.jsx("div",{className:"p-4 bg-crypto-success/10 border border-crypto-success/30 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-crypto-success mb-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:"Message Decrypted Successfully!"})]})}),e.jsx("div",{className:"bg-crypto-bg-tertiary rounded-lg p-4 mb-4 max-h-64 overflow-auto",children:e.jsx("p",{className:"text-white whitespace-pre-wrap",children:x})}),e.jsx("div",{className:"flex gap-4",children:e.jsxs(d,{variant:"primary",className:"flex-1",onClick:C,children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy to Clipboard"]})})]}):e.jsxs("div",{className:"py-16 text-center",children:[e.jsx("svg",{className:"mx-auto h-16 w-16 text-crypto-accent/30 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),e.jsx("p",{className:"text-crypto-text-secondary",children:"Your decrypted message will appear here"})]})]})})]})]})})};export{T as default};
